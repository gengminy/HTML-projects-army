<!Doctype html>
<html>
	<head>
		<meta charset = "UTF-8">
	</head>
	<body>
		<canvas id = "myCanvas" width="600" height="600" style="box-shadow: 2px 5px 20px 3px gray; transition: 0.3s;"></canvas>
		
		<script type = "text/javascript">

			const canvas = document.getElementById("myCanvas");
			const ctx = canvas.getContext("2d");

            class Ball{
                constructor(_x=0, _y=0, _radius=10, _color="black", _canvas=null){
                	this.x = _x;
                	this.y = _y;
                	this.$canvas = _canvas;

                    this._config = {
                    	radius : _radius,
                    	maxGravity : 15,         //최대활강속도

                    	maxValocity : 3.6,
                    	gravityAccelator: 0.5,    //중력 가속도
                    	bounceAccelator: 7.5,    //반작용 가속도
                    	inertiaAccelator: 0.6,    //관성 가속도
                    	color : _color,
                                	
                        item : [],        //아이템

                    	moveLeftKey : 37,
                    	moveRightKey : 39,
                    	itemKey: 32
                    };

                    this._ = {
                    	dx : 0,
                    	dy : 0,

                    	leftPressed : false,
                    	rightPressed : false,
                        onflying : false,        //화살표 블록에 의해 활강중일때

                    	dyingSequence: 0, //죽을때 나오는 이펙트 순서
                        diedX: 0,
                        diedY: 0,
                        ondying : false,            //죽는 이펙트 나오는 중일때

                        breakingSequence: 0,
                        breakX: 0,
                        breakY: 0,
                        onbreaking: false    //블록 부수는 이펙트 나오는 중일때
                    }

                    
                	if(this.$canvas!=null){
                		this._.ctx = canvas.getContext("2d");
                    }

                    
                    //this._audio = {}
                    //this.initAudio();
                    
                }
                
                getConfig = () => this._config
                getPos= () => ({x: this.x, y: this.y});
                getDelta = ()=> ({dx: this._.dx, dy:this._.dy});
                getRadius = ()=> this._config.radius;
                getMaxValocity = ()=>this._config.maxValocity;
                getDiedPos = ()=>({x: this._.diedX, y: this._.diedY})
                getBreakPos = ()=>({x: this._.breakX, y: this._.breakY})

                setDelta(dx, dy){this._.dx = dx; this._.dy = dy;}
                addDelta(dx=0, dy=0){this._.dx += dx, this._.dy += dy;}

                setDiedPos(x=0, y=0){this._.diedX = x; this._.diedY = y;}
                setBreakPos(x=0, y=0){this._.breakX = x; this._.breakY = y;}

                setColor(colorString){this._config.color = colorString;}

                emptyItem(){
                	this._config.item = [];
                	this.setColor(Block.style.ball.background);
                }
                setItem(_type){
                	this._config.item.push(_type);

                    if(_type == Block.type.dashItem){
                        this.setColor(Block.style.ballWithDashItem.background);
                    } else if(_type == Block.type.jumpItem){
                    	this.setColor(Block.style.ballWithJumpItem.background);
                    }
                }

                useItem(){
                	let _itemlist = this._config.item;
                	if(_itemlist.length < 1) return;
                	const _item = _itemlist.pop();

                	if(_itemlist.length < 1) this.setColor(Block.style.ball.background);
                	else{
						if(_itemlist[_itemlist.length-1] == Block.type.dashItem){
							this.setColor(Block.style.ballWithDashItem.background);
						} else if(_itemlist[_itemlist.length-1] == Block.type.jumpItem){
							this.setColor(Block.style.ballWithJumpItem.background);
						}
                	}

                	if(_item == Block.type.jumpItem){
                		this.setDelta(0, -9);
                	} else if(_item == Block.type.dashItem){
                		if(this.isLeftPressed()) this.setDelta(-15, -6);
                		else if(this.isRightPressed()) this.setDelta(15, -6);
                	}
                }

                move(dx=0, dy=0){
                	this.x += dx;
                	this.y += dy;
                }

                draw(){
                	if(this.$canvas == null) return;

                	this._.ctx.beginPath();
					this._.ctx.arc(this.x, this.y, this._config.radius, 0, Math.PI*2);
					this._.ctx.fillStyle = this._config.color;
					this._.ctx.fill();
				    this._.ctx.closePath();	
                }

                drawDyingEffect(){
                	const x = this.getDiedPos().x;
                	const y = this.getDiedPos().y;
                    const i = this._.dyingSequence++;
                    const ctx = this._.ctx;

                    if(60 < i) this._.dyingSequence = 0;

					ctx.strokeStyle = "#FAD700";
					ctx.fillStyle = "#FFDE13";
                    const drawFn = (_x,_y, _i, _mx, _my, _sx, _sy)=>{
                    	const _side = 30;
						const s = _i*3;
						const m = _side/9;
						const _r = _side/_i;
						                    	
						ctx.beginPath();
						ctx.arc(_x+_mx*m+_sx*s, _y+_my*m+_sy*s, _r, 0, Math.PI*2);
						ctx.stroke();
						ctx.beginPath();
						ctx.arc(_x+_mx*m+_sx*s, _y+_my*m+_sy*s, (_r-1>=0?_r-1:_r/10), 0, Math.PI*2);
						ctx.fill(); 	
                    }
                    
                    drawFn(x, y, i, 1, 1, -1, -1);
                    drawFn(x, y, i, -1, 1, 1, -1);
                    drawFn(x, y, i, 1, -1, -1, 1);
                    drawFn(x, y, i, -1, -1, 1, 1);
                }


                 drawBreakingEffect(){
                 	const x = this.getBreakPos().x;
                 	const y = this.getBreakPos().y;
                    const i = this._.breakingSequence++;
                    const ctx = this._.ctx;

                    if(60 < i) this._.dyingSequence = 0;

					ctx.strokeStyle = "#AAA";
					ctx.fillStyle = Block.style.broken.background;
                    
                    const drawFn = (_x,_y, _i, _mx, _my, _sx, _sy,_gx, _gy)=>{
                    	const _side = 30;
						const s = _i;
						const G = _i*_i/15;
						const m = _side/9;
						const _r = _side/5*2/_i;
						                    	
						ctx.beginPath();
						ctx.arc(_x+_mx*m+_sx*s+G*_gx, _y+_my*m+_sy*s+G*_gy, _r, 0, Math.PI*2);
						ctx.stroke();
						ctx.beginPath();
						ctx.arc(_x+_mx*m+_sx*s+G*_gx, _y+_my*m+_sy*s+G*_gy, _r*2/3, 0, Math.PI*2);
						ctx.fill(); 	
                    }

                    drawFn(x, y, i, 1, 1, -1, -1, -1, 1);
                    drawFn(x, y, i, -1, 1, 1, -1, 1, 1);
                    drawFn(x, y, i, 1, -1, -1, 1, 0, 1);
                    drawFn(x, y, i, -1, -1, 1, 1, 0, 1);
                }                
               

                setPos(_x, _y){
                	this.x = _x+this._config.radius;
                	this.y = _y+this._config.radius;
                }

                setGravity(){
                    let G = this._config.gravityAccelator;
                    let A = this._config.inertiaAccelator;

					if(this._.dy + G <= this._config.maxGravity)
						this._.dy += G;


					if(this._.dx + A <= 0)
						this._.dx = Math.round(this._.dx+A);
					else if (this._.dx - A >= 0)
						this._.dx = Math.round(this._.dx - A);
                }

                isLeftPressed = ()=> this._.leftPressed;
                isRightPressed = ()=>this._.rightPressed;
                isFlying = ()=>this._config.onflying;
                isDying = ()=>this._config.ondying;
                isBreaking = ()=>this._config.onbreaking;
                setFlyingStatement(state=true){ this._config.onflying = state; }
                setDyingStatement(state=true){ this._config.ondying = state; this.setDiedPos(this.x+this._.dx,this.y+this._.dy); this._.dyingSequence= 0;}

                setBreakingStatement(state=true, x=0, y=0){ this._config.onbreaking = state; this.setBreakPos(x, y); this._.breakingSequence=0;}

                /* Keyboard Event */
                setKeyboardEvent(){
					document.addEventListener("keydown", (e)=>{
						if(e.keyCode == this._config.moveRightKey) this._.rightPressed = true;
						else if(e.keyCode == this._config.moveLeftKey) this._.leftPressed = true;
						else if(e.keyCode == this._config.itemKey) this.useItem();

                        this.setFlyingStatement(false); //활강 중단
					});
					document.addEventListener("keyup", (e)=>{
						if(e.keyCode == this._config.moveRightKey) this._.rightPressed = false;
						else if(e.keyCode == this._config.moveLeftKey) this._.leftPressed = false;

						this.setFlyingStatement(false); //활강 중단
					});
                }

                initAudio(){
                	/*
					const audioContext = new AudioContext();

					const buffer = audioContext.createBuffer(
						1,
						audioContext.sampleRate * 1,
						audioContext.sampleRate
					);
					const channelData = buffer.getChannelData(0);
					for(let i=0; i<buffer.length; ++i)
						channelData[i] = Math.random() * 2 - 1;

					const primaryGainControl = audioContext.createGain();
					primaryGainControl.gain.setValueAtTime(0.05, 0);
					primaryGainControl.connect(audioContext.destination);

					this._audio.audioContext = audioContext;
					this._audio.buffer = buffer;
					this._audio.channelData = channelData;
					this._audio.primaryGainControl = primaryGainControl;
					*/
                }
                createBoundSound(){
                	/*
                	const audioContext = this._audio.audioContext;
                	const buffer = this._audio.buffer;
                	const primaryGainControl = this._audio.primaryGainControl;

					const snareFilter = audioContext.createBiquadFilter();
					snareFilter.type = "lowpass";
					snareFilter.frequency.value = 800.0;
					snareFilter.connect(primaryGainControl);

					const whiteNoiseSource = audioContext.createBufferSource();
					whiteNoiseSource.buffer = buffer;

					const whiteNoiseGain = audioContext.createGain();
					whiteNoiseGain.gain.setValueAtTime(1000, audioContext.currentTime);
					whiteNoiseGain.gain.exponentialRampToValueAtTime(1.5, audioContext.currentTime+0.025);

	                //vibrato
					const vibrato = audioContext.createOscillator();
					vibrato.frequency.setValueAtTime(18, audioContext.currentTime);
					const vibratoGain = audioContext.createGain();
					vibratoGain.gain.setValueAtTime(1.5, audioContext.currentTime);
					vibrato.connect(vibratoGain);
					vibratoGain.connect(whiteNoiseGain);
					vibrato.start();
	                //


					whiteNoiseSource.connect(whiteNoiseGain);
					whiteNoiseGain.connect(snareFilter);
					whiteNoiseSource.start();
					whiteNoiseSource.stop(audioContext.currentTime+0.1);

					const snareOscillator = audioContext.createOscillator();
					snareOscillator.type = "triangle";
					snareOscillator.frequency.setValueAtTime(80, audioContext.currentTime);

					const oscillatorGain = audioContext.createGain();
					oscillatorGain.gain.setValueAtTime(200, audioContext.currentTime);
					oscillatorGain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
					snareOscillator.connect(oscillatorGain);
					oscillatorGain.connect(primaryGainControl);
					snareOscillator.start();
					snareOscillator.stop(audioContext.currentTime + 0.2);
					*/
                }
            }

            class Block{
                constructor(_x=0, _y=0, _horizon=0, _vertical=0, _type=1){
                    this.x = _x;
                    this.y = _y;
                    this._horizon = _horizon;
                    this._vertical = _vertical;

                    this.type = _type;

                    this.top = _y;
                    this.bottom = _y + _vertical;
                    this.right = _x + _horizon;
                    this.left = _x;

                    if(Block.type.upPannel <= _type && _type <= Block.type.rightPannel){
						this.move = (dx, dy)=>{
							this.x += dx; this.y += dy;
						}

                        this.isCollision = (dx, dy, block)=>{
                            if(block.inBlock(this.x+this._horizon/2+dx, this.y+this._vertical/2+dy))
                                return true;
                            return false;
                        }

						this.moveWithAntimation = (dx, dy, ms)=>{
							const frame = 15;
							for(let i=1; i<=frame; ++i){
								setTimeout(()=>{
									this.move(dx/frame, dy/frame);
								}, ms/frame*i)
							}
						}
                    }
                }


                inBlock(x, y){    //해당 좌표가 이 블록 내부에 있는지 검사
                	if(this.x <= x && x <= this.x + this._horizon && this.y <= y && y <= this.y+ this._vertical)
                	    return true;
                	return false;
                }

                setPos(x, y){
                    this.x = x; this.y = y;
                }


                static type = {
                 	empty: 0,        //void
                	default: 1,      //block
                	jump: 2,
                	broken: 3,

                    //spike
                	upSpike: 4,
                	downSpike: 5,
                	leftSpike: 6,
                	rightSpike: 7,

                    //shooter
                	rightShoot: 8,
                	leftShoot: 9,

                    //moving pannel
                	upPannel: 10,
                	downPannel: 11,
                	leftPannel: 12,
                	rightPannel: 13,

                    //item
                    jumpItem: 90,
                    dashItem: 91,

                    ball: 99,

                    text: 200,
                }

                static style = {
                    default: { background: "#F3F3F3", border: "#AFAFAF" },
                    jump: { background: "#70B7FF", border: "#45A1FF" },
                    broken: { background: "white", border: "#222"},
                    spike: { background: "#FFF", border: "#999"},
                    rightShoot: { background: "#1E8EFF", border: "#0180FF", arrow: "#FFF" },
                    leftShoot: { background: "#1E8EFF", border: "#0180FF", arrow: "#FFF"},

                    verticalPannel: { background: "white", border: "#444", arrow: "#FB0F00" },
                    horizontalPannel: { background: "white", border: "#444", arrow: "#046AFF" },


                    jumpItem: { background: "#F78400", border: "#E47A00" },
                    dashItem: { background: "#2A61FF", border: "#205AFF" },

                    ball: {background: "#FFD400", border: "" },
                    ballWithJumpItem: { background: "#F78400", border: "" },
                    ballWithDashItem: { background: "#2A61FF", border: "" }
                }
            }



            class Stage{
            	constructor(_side=600, _blockSize=30, $canvas=null, ball=null){
                	this.map = [];
                	this._config = {
                		startingPoint: {x: 100, y: 100},
                		side: _side,
                		blockSize: _blockSize,
                		order: 1,

                		deathCount: 0
                	}
                	this._link = {
                		$canvas: $canvas,
                		ball: ball
                	}
                    this._ = {
                        mapList: [

                        //stage1
						[[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1]],
						
					

						//stage2
						[[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 2, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1],
						[1, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 1],
						[1, 1, 1, 4, 4, 1, 4, 1, 4, 4, 1, 1, 4, 1, 3, 0, 0, 0, 0, 1],
						[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1]],						
						[[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],


						//stage3		
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 0, 0, 0, 1],
						[1, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 1, 1, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1]],

						//stage4
						[[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 1, 1, 0, 0, 1, 1, 3, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
						[1, 0, 0, 0, 0, 0, 1, 3, 3, 3, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 1, 3, 3, 3, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 1, 3, 3, 3, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 1, 3, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 1, 3, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 1, 3, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 1, 4, 4, 4, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1],
						[1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1]],


						//stage5
						[[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 1, 1, 1, 4, 4, 1, 4, 4, 1, 1, 4, 1, 1, 4, 4, 1, 0, 0, 1],
						[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 4, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 3, 3, 0, 3, 0, 0, 3, 3, 3, 0, 3, 0, 0, 3, 3, 0, 2, 2, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1]],

                        //stage6
						[[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 0, 0, 4, 4, 4, 4, 4, 4, 1],
						[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1],						
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 4, 1, 4, 1, 1, 4, 4, 1, 1, 4, 1, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 5, 0, 0, 0, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 1, 3, 3, 2, 0, 3, 3, 2, 1, 0, 3, 3, 0, 3, 0, 0, 3, 3, 0]],

						//stage7
						[[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0],
						[1, 0, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 4, 4, 0, 0, 4, 4, 0, 4, 0, 0, 0, 0, 0, 0],
						[1, 0, 1, 1, 1, 2, 1, 1, 2, 0, 1, 1, 1, 1, 1, 2, 0, 1, 1, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],

						//stage8
						[[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 1, 0, 3, 1, 1, 0, 1, 3, 0, 1, 1, 3, 3, 1, 1, 1, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0],
						[1, 2, 1, 0, 1, 0, 3, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1],
						[1, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 4, 0, 4, 0, 0, 1],
						[1, 1, 1, 0, 3, 1, 0, 1, 1, 0, 0, 1, 2, 1, 1, 1, 1, 1, 2, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],		



                        //stage9
						[[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 99, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 3, 3, 3, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 4, 4, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 3, 0, 3, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 3, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 3, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 3, 3, 3, 1],
						[1, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 1, 3, 3, 3, 1],
						[1, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 3, 1],
						[1, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 9, 1],
						[1, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 4, 4, 4, 1],
						[1, 1, 1, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1],						
						[1, 0, 0, 0, 0, 0, 0, 0, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1]],						
						
                        //stage10
						[[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 200, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 99, 0, 0, 0, 90, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],

                        //stage11
						[[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
						[1, 0, 0, 0, 0, 0, 5, 5, 5, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 90, 0, 0, 0, 0, 0, 0, 0, 0, 90, 99, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 4, 4, 4, 1, 1, 4, 4, 4, 4, 1, 1, 1, 1, 1],
						[1, 7, 0, 0, 0, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
						[1, 7, 0, 0, 0, 6, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 7, 0, 0, 0, 6, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 7, 0, 0, 0, 6, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 7, 0, 0, 0, 6, 1, 0, 0, 0, 0, 0, 8, 0, 0, 0, 0, 0, 0, 0],
						[1, 7, 0, 0, 0, 6, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 1, 4, 3, 4, 1, 1, 0, 0, 90, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 1, 1, 3, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 1, 3, 3, 3, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],

                        //stage12
						[[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 1, 1, 1, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 2, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 90, 1, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 90, 0, 0, 0, 0, 0, 0, 9, 1],
						[1, 90, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 99, 90, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 1, 1, 4, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1]],

                        //stage13
						[[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 99, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 3, 3, 3, 1, 1, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 3, 0, 0, 1, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 4, 0, 3, 1, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 3, 3, 1, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 3, 1, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 3, 0, 1, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 3, 3, 3, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 3, 0, 3, 0, 0, 1],
						[1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 3, 3, 0, 0, 1],
						[1, 0, 0, 1, 1, 0, 0, 0, 90, 0, 0, 0, 0, 0, 3, 0, 9, 0, 0, 1],
						[1, 3, 4, 1, 1, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 1],
						[1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
						[1, 0, 0, 0, 5, 0, 0, 0, 0, 5, 5, 5, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 90, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 3, 1, 1, 2, 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1]],

                        //stage14
						[[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
						[1, 0, 0, 5, 5, 5, 5, 5, 0, 5, 5, 5, 5, 5, 0, 0, 0, 0, 0, 1],
						[1, 99, 0, 90, 0, 0, 0, 0, 90, 0, 0, 0, 0, 0, 90, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 1],
						[1, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1],
						[1, 0, 0, 1, 4, 4, 4, 1, 0, 1, 4, 4, 4, 1, 0, 1, 0, 0, 0, 1],
						[1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 4, 0, 0, 1],						
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 7, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 90, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1],
						[1, 0, 0, 0, 2, 0, 0, 0, 0, 0, 2, 0, 0, 0, 2, 1, 1, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],

                        //stage15
						[[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 200, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 99, 0, 0, 91, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],

                        //stage16
						[[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 91, 99, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 4, 4, 4, 4, 4, 4, 1, 1, 1, 1],
						[1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1],
						[1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 3, 3, 3, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 91, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 1, 1, 1, 1, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 91, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1]],

                        //stage17
						[[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
						[1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 99, 91, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 90, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 1, 1, 1, 0, 0, 5, 5, 5, 5, 5, 5, 0, 0, 1, 1, 1, 0, 0, 1],
						[1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 90, 0, 1, 0, 0, 0, 0, 1],
						[1, 0, 0, 1, 0, 0, 0, 0, 91, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1],
						[1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1],
						[1, 0, 0, 1, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 1, 0, 0, 4, 4, 1],						
						[1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 91, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 1, 1, 0, 0, 0, 90, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 1],
						[1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1]],

						//stage18
						[[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
						[1, 0, 99, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 90, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 1],
						[1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 90, 0, 0, 1],
						[1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 1, 0, 0, 0, 0, 91, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 1, 1, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 4, 4, 4, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1]],

						//stage19
						[[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 5, 5, 0, 0, 1, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 91, 1, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 1, 4, 4, 1, 4, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 3, 3, 1, 1, 2, 1, 1, 1, 1, 4, 4, 4, 4, 0, 0, 0, 0, 0, 1],
						[1, 3, 3, 5, 5, 1, 5, 5, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 90, 1, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1],
						[1, 2, 1, 4, 4, 1, 4, 4, 1, 3, 0, 0, 3, 1, 0, 0, 0, 0, 0, 1],
						[1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 3, 0, 3, 1, 0, 0, 0, 0, 0, 1]],

						//stage20
						[[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 1, 1, 1, 1, 13, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],

						//stage21
						[[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
						[1, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 99, 0, 1],
						[1, 7, 0, 0, 0, 0, 0, 3, 0, 0, 0, 3, 3, 0, 0, 0, 12, 0, 0, 1],
						[1, 7, 0, 0, 4, 4, 4, 1, 4, 4, 4, 1, 1, 4, 4, 4, 4, 1, 1, 1],
						[1, 7, 3, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
						[1, 7, 0, 6, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 7, 0, 6, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 7, 0, 6, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 7, 0, 6, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 7, 0, 6, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 7, 3, 6, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 90, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 1],
						[1, 0, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 1],
						[1, 0, 0, 0, 0, 0, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 0, 0, 0, 0, 0, 0, 6, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 0, 6, 1]],


						//stage22
						[[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
						[1, 5, 5, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 90, 6, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 11, 11, 0, 0, 0, 12, 0, 6, 1],
						[1, 0, 0, 0, 13, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 1],
						[1, 0, 0, 0, 4, 4, 4, 4, 4, 4, 4, 0, 0, 4, 4, 4, 4, 4, 1, 1],
						[1, 4, 4, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1],
						[1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1],
						[1, 5, 5, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1],
						[1, 0, 10, 10, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0],
						[1, 0, 4, 4, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0],
						[1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
						[1, 0, 5, 5, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 99, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 4, 4, 4, 4, 1, 1, 1, 0, 0, 1],
						[1, 10, 10, 10, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1]],

						//stage23
						[[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 90, 0, 1],
						[1, 1, 1, 1, 7, 13, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 1, 1, 1, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 1, 7, 0, 0, 6, 1, 1, 1, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 1, 7, 0, 0, 6, 1, 1, 1, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 1, 7, 0, 0, 0, 5, 5, 5, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 1, 7, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 1, 7, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 1, 7, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 1, 7, 0, 0, 0, 0, 0, 0, 1],
						[1, 4, 4, 4, 4, 4, 4, 4, 4, 4, 1, 1, 1, 4, 4, 4, 0, 0, 0, 1],
						[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1],
						[1, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 11, 1],
						[1, 0, 8, 11, 3, 0, 0, 3, 0, 11, 3, 3, 0, 0, 3, 0, 3, 0, 0, 0],
						[1, 0, 0, 0, 0, 10, 0, 0, 0, 0, 0, 0, 0, 10, 0, 0, 0, 4, 4, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1]],

                        //stage24
						[[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
						[1, 5, 0, 5, 0, 0, 0, 0, 0, 5, 5, 5, 5, 5, 5, 5, 5, 1, 1, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 5, 5],
						[1, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 3, 0, 0, 3, 10, 0, 0, 0],								
						[1, 0, 0, 2, 3, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 4, 4, 4],										
						[1, 0, 3, 0, 3, 1, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1],
						[1, 4, 4, 4, 4, 1, 7, 0, 90, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 1, 1, 1, 1, 1, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 1, 4, 4, 4, 4, 4, 4, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 91, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 2, 1, 1, 1, 1],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 90, 1, 0, 0, 0, 0],
						[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0],
						[1, 0, 0, 0, 5, 5, 5, 5, 5, 5, 5, 0, 0, 0, 0, 1, 0, 0, 0, 0],
						[1, 99, 0, 91, 0, 0, 0, 0, 0, 0, 0, 0, 0, 90, 0, 1, 0, 0, 0, 0],
						[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0],
						[1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 0, 0, 0, 0]],

                        ]
                    }

                    if($canvas != null){
                        this._.ctx = canvas.getContext("2d");
                    }
                    this.initializeMap();

                    this.blockList = [];

                    this.textList = {
                    	10: "Press 'SpaceBar' to double jump!",
                    	15: "Press 'SpaceBar' to dash!"
                    };

            	}

                initializeMap(){
                    let blockCount = Math.floor(this._config.side/this._config.blockSize);
                	for(let i=0; i< blockCount; ++i){
                		let p = [];
                		for(let j=0; j<blockCount; ++j){
                			p.push(0);
                        }
                        this.map.push(p);
                	}
                }

/*
//template
[[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],
*/
                
                setMap(idx=1){
                    this.map = this._.mapList[idx];
                    this._link.ball.emptyItem();
                    this._config.order = idx+1;
                    this.createMap();
                }
                setNextMap(){
                	if(this._config.order < this._.mapList.length){
                		this._link.ball.setFlyingStatement(false);
                		this.setMap(this._config.order++);
                    }
                    else console.log('This is the last map');
                }

                getStageOrder = ()=>this._config.order;

                setStartingPoint(x, y){
                	if(0 < x && x < this._link.$canvas.width && 0 < y && y < this._link.$canvas.height){
                	    this._config.startingPoint = {x: x, y: y};
                	}
                    else throw('startingPoint :: position invalid');
                }

                revive(){    //부활
                	let pos = this._config.startingPoint;
                    const origColor = this._link.ball._config.color;
                  
                    this._config.deathCount++;

                    this._link.ball.setDyingStatement(true);
                    this._link.ball.setDelta(0, 0);
                    this._link.ball.setPos(-10, -10);
                	setTimeout(()=>{
                		this._link.ball.setFlyingStatement(false);
                		this._link.ball.setDyingStatement(false);
                		this._link.ball.setGravity();
						this.setMap(this._config.order-1);
						this._link.ball.setDelta(0, 0);
                	}, 500);
                	
                }

                
                setBlockBreakEffect(_x, _y){    //블록부수는이펙트
                    this._link.ball.setBreakingStatement(true, _x, _y);
                	setTimeout(()=>{
                		this._link.ball.setBreakingStatement(false);
                	}, 300);
                	
                }


                createBlock(x, y, type=1){
                	const side = this._config.blockSize;
                    const spikeSize = side/7*4;
                	const bt = Block.type;
                    switch(type){
                    	case bt.empty: break;
                        case bt.default: case bt.jump: case bt.broken:
                        case bt.rightShoot: case bt.leftShoot:
                        case bt.test:

                        //pannels
                        case bt.upPannel: case bt.downPannel: case bt.leftPannel: case bt.rightPannel:
                            this.blockList.push(new Block(x, y, side, side, type));
                        break;

                        //spikes
                        case bt.upSpike: this.blockList.push(new Block(x, y, side, spikeSize, type)); break;
                        case bt.downSpike: this.blockList.push(new Block(x, y, side, spikeSize, type)); break;
                        case bt.leftSpike: this.blockList.push(new Block(x+side-spikeSize, y, spikeSize, side, type)); break;
                        case bt.rightSpike: this.blockList.push(new Block(x, y, spikeSize, side, type)); break;

                        //items
                        case bt.jumpItem: this.blockList.push(new Block(x+side/3, y+side/3, side/3, side/3, type)); break;
                        case bt.dashItem: this.blockList.push(new Block(x+side/3, y+side/3, side/3, side/3, type)); break;

                        case bt.text: this.blockList.push(new Block(x+side/2, y+side/2, 0, 0, type)); break;

                        case bt.ball:
                            this._link.ball.setPos(x+side/2, y+side/2);
                            this._link.ball.setDelta(0, 0);
                            this.setStartingPoint(x+side/2,y+side/2);
                        break;
                    }
                }

                createMap(){
                	let s = this._config.blockSize;
                    this.blockList = [];

                    for(let i in this.map){
                    	for(let j in this.map[i]){
                    		this.createBlock(j*s, i*s, this.map[i][j]);
                    	}
                    }
                }

                drawBlock(){
                	//모서리가 둥근 사각형 그리는 함수
					const roundedRect = (_x, _y, _r, _side)=>{
						const side = _side
						const ox = _x+1;
						const oy = _y+1;

						//background
						ctx.beginPath();
						ctx.moveTo(ox+_r, oy);
						ctx.lineTo(ox+side-_r-2, oy);
						ctx.arc(ox+side-_r-2, oy+_r, _r, Math.PI*3/2, Math.PI*2, false);
						ctx.lineTo(ox+side-2, oy+side-_r-2);
						ctx.arc(ox+side-_r-2, oy+side-_r-2, _r, 0, Math.PI/2, false);
						ctx.lineTo(ox+_r, oy+side-2);
						ctx.arc(ox+_r, oy+side-_r-2, _r, Math.PI/2, Math.PI, false);
						ctx.lineTo(ox, oy+_r);
						ctx.arc(ox+_r, oy+_r, _r, Math.PI, Math.PI*3/2, false);
						ctx.fill();

						//border
						ctx.beginPath();
						ctx.moveTo(ox+_r, oy);
						ctx.lineTo(ox+side-_r-2, oy);
						ctx.arc(ox+side-_r-2, oy+_r, _r, Math.PI*3/2, Math.PI*2, false);
						ctx.lineTo(ox+side-2, oy+side-_r-2);
						ctx.arc(ox+side-_r-2, oy+side-_r-2, _r, 0, Math.PI/2, false);
						ctx.lineTo(ox+_r, oy+side-2);
						ctx.arc(ox+_r, oy+side-_r-2, _r, Math.PI/2, Math.PI, false);
						ctx.lineTo(ox, oy+_r);
						ctx.arc(ox+_r, oy+_r, _r, Math.PI, Math.PI*3/2, false);
						ctx.lineWidth = 1.5;
						ctx.stroke();
						ctx.lineWidth = 1;
					}
                    
                    //(_cx, _cy)를 중심점으로 갖는 삼각형 그리는 함수
					const drawTriangle = (_cx, _cy, _side, type)=>{
						const s = _side/2;
						const pi = Math.PI;
						const h = s/Math.sin(pi/3);
						let p1, p2, p3;

                        switch(type){
                            case Block.type.upPannel: default:
								p1 = {x: _cx-s-1, y: _cy+s}
								p2 = {x: _cx, y: _cy-h}
								p3 = {x: _cx+s+1, y: _cy+s}
                            break;
                            case Block.type.downPannel:
								p1 = {x: _cx-s-1, y: _cy-h}
								p2 = {x: _cx, y: _cy+s}
								p3 = {x: _cx+s+1, y: _cy-h}
                            break;
                            case Block.type.leftPannel:
								p1 = {x: _cx+s, y: _cy-s-1}
								p2 = {x: _cx-h, y: _cy}
								p3 = {x: _cx+s, y: _cy+s+1}
                            break;
                            case Block.type.rightPannel:
								p1 = {x: _cx-s, y: _cy-s-1}
								p2 = {x: _cx+h, y: _cy}
								p3 = {x: _cx-s, y: _cy+s+1}
                            break;
                        }
	
						ctx.beginPath();
						ctx.moveTo(p1.x, p1.y);
						ctx.lineTo(p2.x, p2.y);
						ctx.lineTo(p3.x, p3.y);
						ctx.lineTo(p1.x, p1.y);
						ctx.fill();
					}		

                    //박스 내부에 화살표 그리는 함수
                    const drawArrow = (_x, _y, _side, _type)=>{
                    	let s1, s2, s3;
                    	if(_type == Block.type.leftShoot){
                            s1 = _side/7*6;
                            s2 = _side/7*3;
                            s3 = _side/7;
                    	} else if(_type == Block.type.rightShoot){
                            s1 = _side/7;
                            s2 = _side/7*4;
                            s3 = _side/7*6;
                    	}
						ctx.moveTo(_x+s1, _y+_side/10*4);
						ctx.lineTo(_x+s2, _y+_side/10*4);
						ctx.lineTo(_x+s2, _y+_side/10*2.5);
						ctx.lineTo(_x+s3, _y+_side/10*5);
						ctx.lineTo(_x+s2, _y+_side/10*7.5);
						ctx.lineTo(_x+s2, _y+_side/10*6);
						ctx.lineTo(_x+s1, _y+_side/10*6);
						ctx.lineTo(_x+s1, _y+_side/10*4);
						ctx.fill();
                    }

                    //각 방향에 맞는 가시 그리는 함수
					const drawSpike = (_x, _y, _side, _type)=>{
						let nx, ny, nh;
						const s = _side;
						ctx.fillStyle = Block.style.spike.background;
						ctx.strokeStyle = Block.style.spike.border;
                        if(_type == Block.type.upSpike || _type == Block.type.downSpike){
							if(_type == Block.type.upSpike){ nx = _x; ny = _y; nh = _y+s/7*3; }
							else if(_type == Block.type.downSpike){ nx = _x; ny = _y-s+1; nh = _y+s/7*4; }
							ctx.beginPath();
							ctx.moveTo(nx+2, ny-1+s);
							ctx.lineTo(nx + s/6, nh+1);
							ctx.lineTo(nx + s/6*2, ny-1+s);
							ctx.lineTo(nx + s/6*3, nh+1);
							ctx.lineTo(nx + s/6*4, ny-1+s);
							ctx.lineTo(nx + s/6*5, nh+1);
							ctx.lineTo(nx-2 + s, ny-1+s);
							ctx.lineTo(nx+2, ny-1+s);
							ctx.fill();
							ctx.moveTo(nx+1, ny+s);
							ctx.lineTo(nx + s/6, nh);
							ctx.lineTo(nx + s/6*2, ny+s);
							ctx.lineTo(nx + s/6*3, nh);
							ctx.lineTo(nx + s/6*4, ny+s);
							ctx.lineTo(nx + s/6*5, nh);
							ctx.lineTo(nx-1 + s, ny+s);
							ctx.lineTo(nx+1, ny+s);
							ctx.stroke();
                        } else if(_type == Block.type.leftSpike || _type == Block.type.rightSpike){
 							if(_type == Block.type.leftSpike){ nx = _x-s/7*3-1; ny = _y; nh = nx+s/7*3; }
 							else if(_type == Block.type.rightSpike){ nx = _x-s+1; ny = _y; nh = _x+s/7*4; }
							ctx.beginPath();
							ctx.moveTo(nx-1+s, ny+2);
                            ctx.lineTo(nh+2, ny+s/6);
                            ctx.lineTo(nx-1+s, ny + s/6*2);
                            ctx.lineTo(nh+1, ny + s/6*3);
							ctx.lineTo(nx-1+s, ny+s/6*4);
                            ctx.lineTo(nh+1, ny+s/6*5);
                            ctx.lineTo(nx-1+s, ny-2+s);
							ctx.lineTo(nx-1+s, ny+2);
							ctx.fill();
							ctx.moveTo(nx+s, ny+1);
                            ctx.lineTo(nh, ny+s/6);
                            ctx.lineTo(nx+s, ny + s/6*2);
                            ctx.lineTo(nh, ny + s/6*3);
							ctx.lineTo(nx+s, ny+s/6*4);
                            ctx.lineTo(nh, ny+s/6*5);
                            ctx.lineTo(nx+s, ny-1+s);
							ctx.lineTo(nx+s, ny+1);
							ctx.stroke();
                        }
					}

					const bt = Block.type;
					const bs = Block.style;

                    for(let i in this.blockList){
                    	const b = this.blockList[i];

                    	const x = b.x;
                    	const y = b.y;
                    	const side = this._config.blockSize;
                    	const type = b.type;
                    	const ctx = this._.ctx;
                        const triSide = side/3;

                        ctx.beginPath();

						switch(type){
							case bt.default:    //default
                                ctx.fillStyle = bs.default.background;
                                ctx.strokeStyle = bs.default.border;
                                roundedRect(x,y,2,side);
							break;

							case bt.jump:    //jump block
                                ctx.fillStyle = bs.jump.background;
                                ctx.strokeStyle = bs.jump.border;
                                roundedRect(x,y,2,side);
							break;

							case bt.broken:    //broken block
                                const s = side/9*4-2;
                                const v = side/9*5-2;
                                const nx = x+2;
                                const ny = y+2;

                                const drawFn = (_x, _y, _side)=>{
                                    ctx.strokeStyle = bs.broken.border;
                                	ctx.strokeRect(_x, _y, _side, _side);
                                	ctx.fillStyle = bs.broken.background;
                                    ctx.fillRect(_x, _y, _side, _side);
                                }
                                drawFn(nx, ny, s);
                                drawFn(nx, ny+v, s);
                                drawFn(nx+v, ny, s);
                                drawFn(nx+v, ny+v, s);
							break;

							case bt.upSpike: case bt.downSpike: case bt.leftSpike: case bt.rightSpike:
                                drawSpike(x, y, side ,type);
                            break;

                            //horizontal shoot
							case bt.rightShoot: case bt.leftShoot:
                                ctx.fillStyle = bs.rightShoot.background;
                                ctx.strokeStyle = bs.rightShoot.border;
                                roundedRect(x, y, 2, side);

                                ctx.beginPath();
                                ctx.fillStyle = bs.rightShoot.arrow;
								drawArrow(x, y, side, type);

							break;

                            //verticalPannel
							case bt.upPannel: case bt.downPannel:
                                ctx.fillStyle = bs.verticalPannel.background;
                                ctx.strokeStyle = bs.verticalPannel.border;
                                roundedRect(x, y, 2, side);
                                ctx.fillStyle = bs.verticalPannel.arrow;
                                drawTriangle(x+side/2, y+side/2, triSide, type);
							break;

                            //horizontalPannel
							case bt.leftPannel: case bt.rightPannel:
							    ctx.fillStyle = bs.horizontalPannel.background;
                                ctx.strokeStyle = bs.horizontalPannel.border;
                                roundedRect(x, y, 2, side);
                                ctx.fillStyle = bs.horizontalPannel.arrow;
                                drawTriangle(x+side/2, y+side/2, triSide, type);
							break;

							case bt.jumpItem: case bt.dashItem:
							    const _s = b._vertical;
							    if(type == bt.jumpItem){
									ctx.fillStyle = bs.jumpItem.background;
									ctx.strokeStyle = bs.jumpItem.border;
							    } else if(type == bt.dashItem){
									ctx.fillStyle = bs.dashItem.background;
									ctx.strokeStyle = bs.dashItem.border;
						        }
						        ctx.beginPath();
						        ctx.arc(x+_s/2, y+_s/2, _s/2, 0, Math.PI*2);
						        ctx.fill();
						        ctx.beginPath();
						        ctx.arc(x+_s/2, y+_s/2, _s/2, 0, Math.PI*2);
						        ctx.lineWidth = 1.5;
						        ctx.stroke();
						        ctx.lineWidth = 1;
							break;

							case bt.text:
							    const _text = this.textList[this.getStageOrder()] ?? false;
							    if(!_text) break;

                                Stage.drawText(x, y, _text, "15px", 1.2, "black", "san-serif", "center");
							break;

							case bt.test: //test
							    const _r = side/8;
							    ctx.beginPath();
                                ctx.arc(x+side/4, y+side/4, _r, 0, Math.PI*2);
                                ctx.stroke();
                                ctx.beginPath();
                                ctx.arc(x+side/4*3, y+side/4, _r, 0, Math.PI*2);
                                ctx.stroke();
                                ctx.beginPath();
                                ctx.arc(x+side/4, y+side/4*3, _r, 0, Math.PI*2);
                                ctx.stroke();
                                ctx.beginPath();
                                ctx.arc(x+side/4*3, y+side/4*3, _r, 0, Math.PI*2);
                                ctx.stroke();

							break;
						}
						
						ctx.closePath();
					}
                }


     
                collisionDetectX(){
                     if(!this._link.ball) return;

                     const bx = this._link.ball.x; //ballX
                     const by = this._link.ball.y;   
                     const dx = this._link.ball._.dx;
                     const r = this._link.ball._config.radius;

                     const bt = Block.type;

                     for(let i in this.blockList){
                        const g = this.blockList[i];
                        const gLeft = g.x;
                        const gRight = g.x + g._horizon;
                        const type = g.type;
                            
                        if(!g.inBlock(bx+dx+r, by) && !g.inBlock(bx+dx-r, by)) continue;

                        if(bx <= gLeft && gLeft <= bx + r + dx){ //left bounce


							switch(type){
								case bt.upSpike: case bt.downSpike: case bt.leftSpike: case bt.rightSpike:
									this.revive();
									return true;
                                case bt.jumpItem: case bt.dashItem:
                                    this.blockList.splice(i, 1); 
                                    this._link.ball.setItem(g.type);
                                    return false;						
							}
                            this._link.ball.setFlyingStatement(false);							
                        	this._link.ball._.dx = -4.5;
                            this._link.ball.move(g.x - bx - r, 0);
                            return true;
							
                        } else if(bx - r + dx <= gRight && gRight <= bx){ //right bounce
							switch(type){
								case bt.upSpike: case bt.downSpike: case bt.leftSpike: case bt.rightSpike:
									this.revive();
									return true;
                                case bt.jumpItem: case bt.dashItem:
                                    this.blockList.splice(i, 1); 
                                    this._link.ball.setItem(g.type);
                                    return false;									
							}
                            this._link.ball.setFlyingStatement(false);							
                            this._link.ball._.dx = 4.5;
                            this._link.ball.move(-(bx - r - gRight), 0);
                            return true;
                        }
                     }
                     return false;
                }

                collisionDetectY(){
                    if(!this._link.ball) return;

                    const bx = this._link.ball.x;
                    const by = this._link.ball.y;    //ballY

                    const dy = this._link.ball._.dy;
                    const r = this._link.ball._config.radius;

                    const G = this._link.ball._config.bounceAccelator; //반사 가속도

                    const bt = Block.type; //블록타입
                    

                    for(let i in this.blockList){
                        const g = this.blockList[i];        //ground

                        const gTop = g.y;
                        const gBottom = g.y + g._vertical;
                        const gLeft = g.x;
                        const gRight = g.x + g._horizon;

                        if(!g.inBlock(bx, by+dy-r) && !g.inBlock(bx, by+dy+r)) continue;
                        
						if(by - r + dy <= gBottom && gBottom <= by){	//down bounce
                            switch(g.type){
                            	case bt.downSpike: case bt.leftSpike: case bt.rightSpike:
									this.revive();
									return true;
                                case bt.jumpItem: case bt.dashItem:
                                    this.blockList.splice(i, 1); 
                                    this._link.ball.setItem(g.type);
                                    return false;					

								default: this._link.ball._.dy = -dy;
                            }											
							this._link.ball.move(0, by - (g.y + g._vertical) + r);
							return true;
						}
						else if(gTop < by + r + dy){ //up bounce

							switch(g.type){
                                case bt.jump: 
                                    this._link.ball._.dy = -G*1.6;
                                    return true; //jump block;
                                case bt.broken:
                                    this.blockList.splice(i, 1); 
                                    this.setBlockBreakEffect(gLeft + g._horizon/2, gTop + g._vertical/2);
                                    this._link.ball.createBoundSound();
                                    this._link.ball._.dy = -G;
                                    break; //broken block;
                                case bt.upSpike: case bt.leftSpike: case bt.rightSpike:    //up spike block
									this.revive();
									return true;
                                case bt.rightShoot:  //right shoot
                                    this._link.ball.setPos(g.x + g._horizon + r, g.y+g._vertical/2-r);
                                    this._link.ball.setDelta(10, 0);
                                    this._link.ball.setFlyingStatement(true);
                                    return true;
                                break;
                                case bt.leftShoot: //left shoot
									this._link.ball.setPos(g.x - r, g.y+g._vertical/2-r);
                                    this._link.ball.setDelta(-10, 0);
									this._link.ball.setFlyingStatement(true);
									return true;
                                break;
                                //pannels
                                case bt.upPannel: case bt.downPannel: case bt.rightPannel: case bt.leftPannel:
                                     const _m = [{dx:0, dy:-g._vertical}, 
                                     	{dx:0, dy:g._vertical},
                                     	{dx:-g._horizon, dy:0},
                                     	{dx:g._horizon, dy:0}]

                                     const _dx = _m[g.type-bt.upPannel].dx;
                                     const _dy = _m[g.type-bt.upPannel].dy;
									 for(let i in this.blockList){
										const b = this.blockList[i];
										if(g.isCollision(_dx, _dy, b)){
											this._link.ball.createBoundSound();
											this._link.ball._.dy = -G;			
											this._link.ball.move(0, gTop - by - r);					
                                            return true;
										}
									 }                                
                                     g.moveWithAntimation(_dx, _dy, 80);
                                     break;

                                case bt.jumpItem: case bt.dashItem:
                                    this.blockList.splice(i, 1); 
                                    this._link.ball.setItem(g.type);
                                    return false;

                                default:
							}
							this._link.ball.createBoundSound();
							this._link.ball._.dy = -G;							
							this._link.ball.move(0, gTop - by - r);

							return true;
						}	                        
                    }
                    return false;

                }


                static drawText(_x, _y, _txt, _fontSize="16px", _fontWeight=1, _color="black", _fontFamily="san-serif", _align="start", _fill=false){
                	const origAlign = ctx.textAlign;
                	const origWidth = ctx.lineWidth;
                    ctx.textAlign = _align;
                    ctx.font = `${_fontSize} ${_fontFamily}`;
                    
                    ctx.lineWidth = _fontWeight;

                    if(!_fill){
						ctx.strokeStyle = _color;
						ctx.strokeText(_txt, _x, _y);
                    }else{
						ctx.fillStyle = _color;
						ctx.fillText(_txt, _x, _y);
                    }

				    ctx.lineWidth = origWidth;
				    ctx.textAlign = origAlign;
                }
            }



			let style = {
				title1: {background: "#3689FF", border: "#3178FC"},
				title2: {background: "#FFE908", border: "#EBD70C"},
				button: {background: "#F5F5F5", border: "black", text: "black", hover: "#282828"},
				ball: {background: "#FFD400", border: "" },
			}

			function drawOpening(){

				Stage.drawText(canvas.width/19*6, canvas.height/3, 'BOUNCE', "70px", 1, style.title1.background, "Comic Sans MS", "center", true);
				Stage.drawText(canvas.width/19*6, canvas.height/3, 'BOUNCE', "70px", 4, style.title1.border, "Comic Sans MS", "center", false);

				Stage.drawText(canvas.width/19*15, canvas.height/3, 'BALL', "70px", 1, style.title2.background, "Comic Sans MS", "center", true);
				Stage.drawText(canvas.width/19*15, canvas.height/3, 'BALL', "70px", 3, style.title2.border, "Comic Sans MS", "center", false);				

				function drawRoundedButton(_x, _y, _width, _height, _r, _text, _fontSize=15, _textColor="black",  _buttonColor="white", _borderWidth="1px" , _borderColor="black"){
					const pi = Math.PI;
					const LT= {x: _x - _width/2 , y: _y - _height/2 - _fontSize/3};
					const RT= {x: _x + _width/2, y: _y - _height/2 - _fontSize/3};
					const RB= {x: _x + _width/2, y: _y + _height/2 - _fontSize/3};
					const LB= {x: _x - _width/2, y: _y + _height/2 - _fontSize/3}

					canvas.addEventListener("click", function(e){
						const p = {x: e.clientX - this.offsetLeft, y: e.clientY - this.offsetTop}
						if(ctx.isPointInPath(p.x, p.y)) draw();
					})

					function drawBody(_fill = _buttonColor , _border = _borderColor){
						ctx.beginPath();
						ctx.arc(LB.x + _r, LB.y - _r, _r, pi/2, pi);
						ctx.arc(LT.x + _r, LT.y + _r, _r, pi, pi/2*3);
						ctx.arc(RT.x - _r, RT.y + _r, _r, pi/2*3, pi*2);
						ctx.arc(RB.x - _r, RB.y - _r, _r, 0, pi/2);
						ctx.lineTo(LB.x + _r, LB.y);
						ctx.lineWidth = _borderWidth;
						ctx.strokeStyle = _border;
						ctx.stroke();
						ctx.lineWidth = 1;

						ctx.fillStyle = _fill;
						ctx.fill();
					    ctx.closePath();
					}


					function addClickEvent(){

                    }

					drawBody();
					Stage.drawText(_x, _y, _text, `${_fontSize}px`, 1, _textColor, "Comic Sans MS", "center", true);
				}

				drawRoundedButton(canvas.width/2, canvas.height/7*5, 200, 40, 20, "EDITOR", 20, style.button.text, style.button.background, 3 ,style.button.border);
				drawRoundedButton(canvas.width/2, canvas.height/5*3, 200, 40, 20, "START", 20,style.button.text, style.button.background, 3 ,style.button.border);
			}



/*
            function drawEditor(){
            	const editorBall = new Ball(200, canvas.height-200, 8, Block.style.ball.background, document.querySelector("#myCanvas"))
            	const _blockSize = 25
            	const editorStage = new Stage(600, _blockSize, document.querySelector("#myCanvas"), ball);
                const _margin = 10;

                let row = 0;
                let col = 0;


                function drawAllBlock(){
                    canvas.onclick = ()=>{}

					for(let i in Block.type){
						if(row*(_blockSize+_margin) >= Math.floor(canvas.width)){ row = 0; col++ };

						const b = {x: row*(_blockSize + _margin) + _margin, y: col*(_blockSize + _margin)+_margin}
						editorStage.createBlock(b.x, b.y, Block.type[i]);

						canvas.addEventListener("click", function(e){
							const p = {x: e.clientX - this.offsetLeft, y: e.clientY - this.offsetTop}
							if(b.x-_margin/3 <= p.x && p.x <= b.x+_blockSize+_margin/3*2 && b.y-_margin/3 <= p.y && p.y <= b.y+_blockSize+_margin/3*2){
								ctx.beginPath();
								ctx.strokeStyle = "red";
								ctx.rect(b.x-_margin/3, b.y-_margin/3, _blockSize+_margin/3*2, _blockSize+_margin/3*2);
								ctx.lineWidth = 1.5;
								ctx.stroke();
								ctx.lineWidth = 1;
								ctx.closePath();
							}
						});
						row++;
					}
                }
                drawAllBlock();

                editorStage.drawBlock();

                ctx.beginPath();
                ctx.strokeStyle = "black";
                ctx.rect(_margin/2, _margin/2, canvas.width-_margin, (col+1)*(_blockSize+_margin-1))
                ctx.stroke();
                ctx.closePath();
            }
*/







            let ball = new Ball(200, canvas.height-200, 8, Block.style.ball.background, document.querySelector("#myCanvas"));
            ball.setKeyboardEvent();

            let stageTheme1 = new Stage(600, 30, document.querySelector("#myCanvas"), ball);
            stageTheme1.setMap(0);

            let animation = 1; //drawAnimation

			function draw(){
				ctx.clearRect(0, 0, canvas.width, canvas.height);


				ball.draw();
				stageTheme1.drawBlock();


                let x = ball.getPos().x;
                let y = ball.getPos().y;
                let r = ball.getRadius();
                let dx = ball.getDelta().dx;
                let dy = ball.getDelta().dy;
                let stageOrder = stageTheme1._config.order;
                let stageName = `STAGE ${stageOrder}`;
                let deathCount = stageTheme1._config.deathCount;
                let score = `DEATH ${deathCount}`;

                const maxValocity = ball.getMaxValocity();
                const blockSize = stageTheme1._config.blockSize;


                //충돌 감지 안될때만 이동, 감지되면 자동으로 벽에 붙음
                if(!stageTheme1.collisionDetectX())
				    ball.move(dx, 0);
				
				if(!stageTheme1.collisionDetectY())
				    ball.move(0, dy);


                //정보 관련 입력
                Stage.drawText(565, 50, stageName, "16px", 1.2, "black", "san-serif", "end");
                Stage.drawText(565, 50, stageName, "16px", 1.2, "black", "san-serif", "end", true);
                Stage.drawText(565, 65, score, "15px", 1.2, "black", "san-serif", "end");
                Stage.drawText(565, 65, score, "15px", 1.2, "black", "san-serif", "end", true);

                //죽을때 500ms 동안 사망 이펙트 출력
                if(ball.isDying())
                    ball.drawDyingEffect();

                //블록 부수는 이펙트 출력
                if(ball.isBreaking())
                    ball.drawBreakingEffect();


                //캔버스 벽 우측으로 넘어가면 다음 스테이지로
				if(x+r+dx > canvas.width) 
					stageTheme1.setNextMap();
				
				//추락하면 부활
				if (y > canvas.height){ 
				    ball.move(0, -40);
                    stageTheme1.revive();
				}

				//화살표 블록으로 인한 활강중이 아닐때만 중력 적용
				if(!ball.isFlying())
					ball.setGravity();
				
				//키 입력하면 활강 중단
				if(ball.isRightPressed() || ball.isLeftPressed())
				    ball.setFlyingStatement(false);

				//우측이동
				if(ball.isRightPressed() && x < canvas.width - r && dx + 1.2 <= maxValocity){
					ball._.dx += 1.2;
				} else if( ball.isLeftPressed() && x > r && dx - 1.2 >= -maxValocity){ //좌측이동
					ball._.dx -= 1.2;
				}
                animation = requestAnimationFrame(draw);
			}
			drawOpening();

			//drawEditor();

		</script>
	</body>
</html>